	\chapter{Soil Structure Interaction analysis} \label{ch6}
	
	The current chapter presents the analysis performed in 2D plane stress domain of the soil-footing(-structure) interaction considering a shallow foundation subjected to a recorded acceleration-time history. Various methods of seismic implementation are carried out to examine aspects such as load effects on soil response, effectiveness of energy dissipation mechanisms and soil detachment occurrence.
	
	\section{New design philosophy}
	As previously presented, the new design philosophy suggests a different perspective on the induced non-linearity over the soil-structure assembly. Researchers involved within this study showed \mbox{several} effects associated with soil "failure" as acting beneficially in case of seismic ground motion. The interest in the current essay is to apply such approach on a different setting: soft soils, lack of bedrock, induced, and not tectonic, earthquakes together with shallow foundations. In order to summarize the goals, it is utmost important to define the characteristic non-linear effects:
	\begin{itemize}
		\item separation at soil-footing surface under rocking vibration originating from the soil layer also known as \textit{uplifting} that occurs when negligible interface tensile capacity is considered.
		\item mobilisation of the bearing capacity type of failure surface mechanism arises when experiencing large cyclic overturning moments - \textit{soil failure}.
		\item plastification of the underlying ground in the proximity of the edges of the foundation \mbox{described} by large vertical stresses.
	\end{itemize} 
	
	\section{Problem definition}
	The former chapter gets extended towards a 2D plane stress problem involving a homogeneous soil layer supporting a shallow foundation and the entire structure is subjected to a seismic input motion. The study aims at inspecting the inelastic soil response, the proposed method accuracy and its limitations. The final goal is to be able to acknowledge the new design philosophy suitability for this specific earthquake in Groningen area.
	
	\section{Model description}
	As expected, the soil properties do not change drastically, for all the work that was previously conducted proves the parameters validity. The preceding model (1D soil column) is expanded into a larger soil layer supporting a shallow foundation. The resting building relates to a chimney located in the north of Netherlands and it was chosen for its relatively simple geometry together with available structural properties and it can be seen in Figure \ref{chimney}.
	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.7 \linewidth]{"chimney"}
		\caption{Real structure objected to study}
		\label{chimney}
	\end{figure} 
	
	The chimney is represented by a rectangular footing with a lumped mass on top of a slender, infinitely rigid pier. Moreover, the footing is also considered to behave in a stiff fashion when seismically loaded. The main emphasis is on the soil response rather than on the structural one, thus the simplification.
	
\section{Method of analysis}
Inelastic soil response investigation is implemented numerically with a finite element method considering two-dimensional plane strain assumptions; both the soil medium and the footing are modelled as deformable solids using quadrilateral, continuum elements, the superstructure simplified to a pier is assigned with a beam element section whilst the lumped mass is represented by a mass element. A state-of-art contact algorithm defines the soil-structure interface incorporating uplifting and sliding features whereas purely elastic impact assumption is adopted. Every analysis starts with a static step - the geostatic step in which initial stress conditions are established.  

The dynamic analyses operate through an implicit direct-integration algorithm - global equations of motion are integrated in time domain via implicit Hilber-Hughes-Taylor operator. Newton's method includes the $\alpha$ and $\beta$ parameters with the values explained in the previous chapter. The numerical stability is achieved by calibrating both the mesh size and the time-step increment - such way elastic wave propagation laws are not violated. A schematization of the FE model can be seen in Figure\ref{ff} followed by a detailed description of the model.

\subsection{Analysis procedure - Steps}
Every analysis begins with the calculation of the in-situ stresses to establish the geostatic conditions. Gravity load is applied all over the soil medium, simulating the real status when no foundation is resting on the ground. 

Further, the footing presence is reproduced using a point load applied at its centre of the mass. This method relates to the mechanics of the software as well - as the foundation is declared as a rigid body, the program requires the definition of a reference point which will become the simplified representation of the section: every load or boundary condition imposed to the footing is prescribed to this very point only. Thus, the available structural uniform load distribution was converted into a point load and applied to the reference point in discussion. This way, the foundation self weight is reproduced together with the activation of the soil-footing interface. 

Lastly, the seismic excitation must be integrated within the model. Many approaches are formulated in the scientific literature regarding the simulation of the earthquake action for obtaining an accurate results. Numerous methods relate to the implementation of boundary conditions as the problem becomes non-linear and it is subjected to wave propagation. Stability, computational expenses and model dimensions play an important role for the accuracy of the output and require most attention.  Henceforth, different types of boundary conditions were imposed that mimic the acceleration time history in distinct manners. Important to keep in mind that some methods do not necessarily require dynamic algorithms, a quasi-static analysis is preferable for such cases - this aspects will be explained in detail later in this chapter.

Thus, there are three main steps conducted within all analyses:
\begin{enumerate}
	\item \textbf{Geostatic} - for introducing the initial stress conditions of a free-field;
	\item \textbf{Self weight application} - the perturbation on the stresses close to the surface due to the presence of the footing;
	\item \textbf{Dynamic/ Quasi-static} - applying the seismic input in various manners to simulate the earthquake motion.
\end{enumerate}

\subsection{Contact definition}
An important role in uplifting triggering is played by the contact definition - the user can create and customize the interface properties accordingly to the desired application. In finite element analysis, contact conditions describe a particular category of discontinuities, enabling forces to be transmitted from one part to another. The model must recognize and distinguish when the parts are in contact and when separation occurs in order to apply the constraints properly. 

Abaqus offers the possibility of defining contact pairs or contact elements; the former is recommended and it is based on the master-slave approach. In addition, it allows the definition of these entities as surfaces or a collection of nodes - the differences refer to methods of discretization and calculation. In order to define a contact, its interaction properties have to be formulated - again, Abaqus allows the user to customize these features in correspondence with the model in use. For this particular case, only mechanical properties were created. An advanced contact algorithm is applied in order to permit uplifting and sliding and, additionally, to control their development during the seismic excitation. 

As previously mentioned, the study investigates two types of soil-footing contact: \textit{fully bonded} and \textit{tensionless sliding interface}. The advanced algorithm referes to the sliding interface whilst the fully bonded contact is effortlessly depicted through a \textbf{Tie constraint} - using the same master-slave formulation, it provides a simple way of bounding the two surfaces permanently, preventing sliding/separation.

However, the tensionless sliding interface requires much more attention and research as it incorporates various features that will be detailed further on.
 
\paragraph{Mechanical properties}   
The contact is described for both normal and tangential direction, more precisely a pressure-overclosure relationship illustrates the normal behaviour whereas a frictional interaction deals with the tangential behaviour. 

For normal direction, Abaqus implements a "hard-contact" relationship by default which consists of:
\begin{itemize}
	\item no penetration of master surface into the slave;
	\item no upper bound for the transmitted contact pressure;
	\item no stress transfer between surfaces when there is no contact detected.
\end{itemize}

Nonetheless, the current study indicates another type of normal contact, a softened one involving a pressure-overclosure relationship. According to Abaqus documentation, the softened contact can be introduced as linear or exponential, the latter being preferred. In an exponential (soft) contact pressure-overclosure relationship the surfaces begin to transmit contact pressure once the clearance between them, measured in the contact (normal) direction, reduces to $c_0$. The contact pressure transmitted between the surfaces then increases exponentially as the clearance continues to diminish. The schematization of the relationship can be visualized in Figure \ref{pressure}.
\begin{figure}[!h]
	\centering
	\includegraphics[width=0.45 \linewidth]{"pressure"}
	\caption{Exponential “softened” pressure-overclosure relationship in Abaqus/Standard}
	\label{pressure}
\end{figure} 

where $p_0$ is the contact pressure at zero distance, $ c_0$ is the distance from the master surface at which the pressure is decreased to 1 \% of $ p_0$. The behaviour in between is exponential. A large value of $ c_0$ leads to soft contact, a small value to hard contact. It is difficult to know a priori which values are suitable, however literature studies suggest for $p_0=10 kPA$ correlated with a clearance $c_0=10E^{-5} m$.


For the tangential behaviour, the software provides the following options:
\begin{itemize}
	\item frictionless - default;
	\item rough - no slip is allowed;
	\item penalty friction which allows for:
		\begin{itemize}
			\item Coulomb friction law $T=\mu N$;
			\item constant shear limit at surface;
			\item friction coefficient as a function of the slip rate and contact pressure;
		\end{itemize}
\end{itemize}

Considering the cohesive character of the soil, the Coulomb friction law might not be the appropriate solution, thus the second option was chosen. Thus, the frictional behaviour is actually a cohesive one. This shear stress limit is typically introduced in cases when the contact pressure stress may become very large causing the Coulomb theory to provide a critical shear stress at the interface that exceeds the yield stress in the material beneath the contact surface. A reasonable upper bound estimate for $\tau_{max}$ is $\sigma_y/\sqrt{3}$, where $\sigma_y$ is the Mises yield stress of the material adjacent to the surface. In some cases some incremental slip may occur even though the friction model determines that the current frictional state is “sticking.” In other words, the slope of the shear (frictional) stress versus total slip relationship may be finite while in the “sticking” state, as shown in Figure \ref{stick}.

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.5\linewidth]{"stick"}
	\caption{Elastic slip versus shear traction relationship for sticking and slipping friction}
	\label{stick}
\end{figure} 

The relationship shown in this figure is analogous to elastic-plastic material behavior without hardening: K corresponds to Young's modulus, and $\tau_{crit}$ corresponds to yield stress; sticking friction is associated with the elastic regime, and slipping friction to the plastic one. A typical average value recommended in the literature for the elastic slip is 0.1mm and it seems appropriate for this case as well.

\paragraph{Contact interface discretization}
Having all interaction properties defined, the contact itself must be formulated; the most suitable interaction option Abaqus/Standard offers is \textit{Surface-to-surface}; the contact discretization can be chosen node-to-surface (N-S) or surface-to-surface (S-S), the latter being preferable. Firstly, because the conditions will be enforced based on an average region instead of strictly node-wise. The averaging regions are approximately centered on slave nodes, so each contact constraint will predominantly consider one slave node but will also consider adjacent slave nodes. Secondly, this option does not include spikes in the pressure distribution along the surface, as it happens in the N-S case. Lastly, large and unintended penetration of master nodes into slave does not occur leading to a smoothing effect.

The sliding formulation require for the interaction implementation also has two options: finite sliding or small sliding. The second alternative is more convenient, as the footing will not slide considerable. Additionally, coupling of slave nodes with their projections on master surface
is calculated at the beginning of the analysis and does not change throughout the analysis,
whereas for finite sliding approach, this coupling is checked and recalculated throughout the
analysis.

\subsection{Boundary conditions}
For this type of application, it becomes necessary to define two sets of boundary conditions: the \textit{global} and the \textit{local} ones. The first set assumes the top surface as being constraint-free, whilst rigid bottom is initially defined. The lateral boundaries are both vertically and horizontally constrained.
Nevertheless, in dynamic analyses, a fixed boundary condition will lead to wave reflection at the outer limits of the model translated into energy trapped inside the model. This effect becomes detrimental, therefore solutions must mitigate reflective waves propagating throughout the model. One way is to create a large enough model to simulate an infinite medium - however, the calculation can become quite time and space consuming, thus the need of another concepts. Many researchers proposed methods of tackling the problem, here highlighting the work of  \textbf{Zienkiewicz et al (1989) \cite{zienkiewicz1989earthquake}, Lysmer and Kuhlemeyer} \cite{zienkiewicz1989earthquake} and many more ()

\paragraph{Theory of wave propagation}
For the simplicity of the problem, vertically propagating waves were considered exclusively; it is also well known that both the body waves - P waves and S waves - are independent of each other. According to Love(1944) \cite{love1944h}, the wave equation for an isotropic elastic medium is:

\begin{equation}
c_p^2\bigtriangledown(\bigtriangledown\cdot u) - c_s^2\bigtriangledown \times \bigtriangledown \times u = \frac{\partial^2 u}{\partial t^2}
\end{equation} 

where, according to D'Alembert equation solution, $c_p$ is the P-wave velocity ($c_p=\sqrt{\frac{\lambda + 2 \mu}{\rho}}$) and $c_s$ is the S-wave velocity ($c_s=\sqrt{\frac{\mu}{\rho}}$) with $\lambda$ and $\mu$ as Lamé constants and $\rho$ the density of the medium.

It becomes clear that when working with seismically propagating waves, the real challenge lies in the a correct implementation of artificial boundaries construction rather than defining the propagating medium. Important to mention are the two conditions required by a surface of a wave front as Nielsen, 2006 \cite{nielsen2006absorbing} states in his research:
\begin{enumerate}
	\item \textbf{kinematical} which can be written under the form:
	\begin{equation}
		\frac{1}{\cos(\theta)}\frac{\partial u}{\partial x}= \frac{1}{sin(\theta)}\frac{\partial u}{\partial y} = - \frac{1}{c}\frac{\partial u}{\partial t}
	\end{equation}
		\begin{equation}
		\frac{1}{\cos(\theta)}\frac{\partial v}{\partial x}= \frac{1}{sin(\theta)}\frac{\partial v}{\partial y} = - \frac{1}{c}\frac{\partial v}{\partial t}
	\end{equation}
	 where $\theta$ is the angle of incidence between the surface wave front and the incident waves and c is the wave velocity that depending on the direction can be either associated with compressive or shear waves.
	\item \textbf{dynamical} are expressed in terms of traction forces coplanar with the wave front
	\begin{equation}
		\rho c \frac{\partial u}{\partial t}= - f_x
	\end{equation}
		\begin{equation}
		\rho c \frac{\partial v}{\partial t}= - f_y
		\end{equation}
\end{enumerate} 

In the following section \ref{implemenent} , several boundary condition concepts are presented highlighting the necessity of each. The section includes information describing the methods, differences between the studies, limitations and mathematical background. This represents one principal goal the current paper strives to achieve - an extended investigation to understand what various boundaries influence the performance of the FE model and thus decide which one is more suitable for this application.

There are a couple of methods that are well known in literature and are tested within the section and presented as it follows: 
 \paragraph{Tied lateral boundaries}
	The traditional approach considers pairs of lateral nodes being tied together such way that the horizontal and vertical displacement are equal throughout the entire analysis. This feature can be easily achieved using Abaqus MPC (multi-point constraint) option specifically designed for this situation. The assumption is in conformity with Zienkiewicz's work stating that the presence of the structure on soil oscillation is negligible when the boundaries are sufficiently far.
	Subsequently, the input motion is introduced at the vertically fixed base of the model that replicates the presence of the bedrock. As previously discussed, the acceleration signal obtained from the dataset for Groningen field was recorded at borehole depth, not at bedrock, which means that the recordings can include both incident and reflected waves. In order to exclude an overestimation of the real input signal, the accelerogram was truncated in half to ensure that only upward travelling waves are considered.
	Nevertheless, this method can be formulated in the FE product either through a dynamic or a quasi-static step depending whether the earthquake is expressed in terms of total displacements or total accelerations.
	However attractive this simple method might be, its shortcomings originate from both the lack of an actual bedrock or from the uncertainties rising when defining the model dimensions - there are no rule of thumbs for determining the truncation of the mathematical model.
	
	\paragraph{Transmitting boundaries}
	Given the flaws of the aforementioned concept, it becomes necessary to incorporate features as radiation boundaries that guarantee the outgoing waves are not reflected at the boundary surfaces. 
	
	Transmitting boundaries or absorbing boundaries (\textit{ABC}) were first proposed by Lysmer and Kuhlemeyer (1969) \cite{lysmer1969finite}, followed by Zienkiewicz (1989) \cite{zienkiewicz1989earthquake}. As the name also hints, these types of boundaries are used in the form of viscous boundary tractions or dashpots in order to absorb the normal incident waves. They can be declared both globally or locally, the later proving more appealing from the numerical implementation point of view.
	
	The reason why these types of boundaries are adopted for the FE model expresses the necessity of preventing the occurence of reflected waves whilst capturing correctly the incoming waves at the boundaries. It can be regarded as a simulation of the "horizontal infinity" of a real soil layer. It proves well-suited when associated with an internal source of excitation, however it requires improvements when the input signal originates from external sources. The solution upgrade relates to the theory proposed by Zienkiewicz, also known as \textit{free-field boundary conditions} which introduces the combination between viscous boundaries and a free-field soil column.
	
	Having in mind that for a simple one dimensional, homogeneous, elastic, isotropic wave propagation problem, the free surface displacement wave equals the double of the incoming waves, it can be deducted that the input signal can be extracted from the recorded total signal on the undeformed surface. The free-field soil column allows the user to obtain sets of incoming waves parameters (displacement, velocity, acceleration) in time domain at a known position and correlate them with the viscous boundaries located at the sides of the model. As a consequence, outside the boundaries, the elastic and isotropic conditions pertain.
	 
	The theoretical background of the free-field boundary element was proposed in an efficient manner by Lysmer and Kuhlemeyer that associates the vertical free-field soil column with viscous boundary tractions. This way, the incoming wave takes the form of equivalent forces, rather than accelerations. The traction consists of two terms as it follows:
	\begin{enumerate}
		\item viscous dashpots absorb incoming waves;
		\item free-field motion simulating the undisturbed soil layer;
	\end{enumerate}
Henceforth, the equations describing the tractions, both normal $f_n$ and shear $f_s$ are:
\begin{equation}
	f_n=\rho c_p (\frac{\partial u_`}{\partial t}-\frac{\partial u}{\partial t})+l_x \sigma^`_x
\end{equation}
\begin{equation}
f_s=\rho c_s (\frac{\partial v_`}{\partial t}-\frac{\partial v}{\partial t})+l_x \tau^`_{xy}
\end{equation}
where prime quantities relate to the free-field output values, lx =-1 or lx=1 for outward normal points either negative or positive direction. First term of the equations represents the Lysmer and Kuhlemeyer traction due to the presence of dashpots whereas the second term represents the stress resulting from free-field wave propagation, including eventual static reaction forces.

Gathering all information, the modelling scheme should consist of two, perhaps three calculations as it can be seen in Figure \ref{ff} :
\begin{enumerate}
	\item one model for each column generating the free-field soil response;
	\item one main model representing the soil - footing interaction including viscous dampers at the lateral boundaries;
\end{enumerate} 

	\begin{figure}[!h]
		\centering
		\includegraphics[width=0.7\linewidth]{"free-field"}
		\caption{Real structure objected to study}
		\label{ff}
	\end{figure} 
	
\section{Implementation of ABC} \label{implemenent}
The aforementioned features of the free-field boundary conditions are detailed below, starting with the free-field soil column followed by the main model description together with various modelling techniques. 
	\paragraph{Free-field soil column}
	The free-field soil column performs similar to a vertical soil medium located far enough from the actual foundation for the vibrations not to perturb its state stress. This can be simply implemented as the one-dimensional column subjected to seismic excitation, identical to the model created for the site response analysis. Its advantages involve the option of extracting the results at any desired node, converting them into input for further calculations. Moreover, these results aid reducing the size of the main model domain and this saves the procedure considerable time. Thus, the previous analysis becomes essential as it ticks all the boxes. 
	
	It is worth to acknowledge the constraints linking pairs of lateral nodes in order to maintain equal horizontal displacements along the seismic test. Then, it suffices extracting the outcome from one set of lateral nodes, left or right displaying equal results. The output yields displacement, velocity and acceleration time histories for each lateral node - allowing a further implementation into the main model.
	
	A series of results are presented below:
		\begin{figure}[h!]
			\centering
			\includegraphics[width=0.7\linewidth]{"acc_FF"}
			\caption{Acceleration time history output at base and surface level}
			\label{Acc_ff}
		\end{figure} 
		
		\begin{figure}[h!]
				\centering
				\includegraphics[width=0.7\linewidth]{"velocity_FF"}
				\caption{Velocity time history output from Free field soil column}
				\label{velo}
			\end{figure} 
			
		\begin{figure}[!h]
					\centering
					\includegraphics[width=0.7\linewidth]{"DIsp_ff"}
					\caption{Horizontal displacement time history}
					\label{disp_ff}
				\end{figure} 
				
	\newpage
	\paragraph{Main model}
	The main model, as it can be seen in Figure \ref{mainM}, consists in few features such as:
	\begin{enumerate}
		\item \textit{soil medium} - a homogeneous clay layer, solid, deformable, displaying non-linear kinematic hardening. Same material and meshing properties as the free-field column.
		\item \textit{footing} -  rectangular solid, deformable, meshed with continuum elements behaving elastically.
		\item \textit{mass} - concentrated mass represented by a point assigned with inertial mass. It is in conformity with the assumption of a SDOF system.
		\item \textit{pier} - beam element, infinitely rigid representing the chimney itself.
		\item \textit{contact interface} - special algorithm contact;
	\end{enumerate}
	
		\begin{figure}[!h]
			\centering
			\includegraphics[width=0.9\linewidth]{"mainmodel"}
			\caption{Schematization of the main FE model}
			\label{mainM}
		\end{figure}
		
	The steps were presented before, the boundary conditions change accordingly to each method of implementation.The absorbing boundaries proposed by Lysmer and Kuhlemeyer - which can be efficiently implemented as viscous dampers or dashpots assigned to lateral boundaries of the soil medium - are evaluated performance-wise in correlation with seismic loading procedures. These dampers indicate a local boundary that absorb the incoming wave - their accuracy increase proportionally with distance from the area of interest(footing) and if they are defined as frequency independent. Abaqus allows the user to specify dashpots connected to the ground - an option requiring the definition of the local DOF direction and the dashpot coefficient. In dynamic analysis the velocities are obtained as part of the integration operator; in quasi-static analysis in Abaqus/Standard the velocities are obtained by dividing the displacement increments by the time step. Additionally, it can model relative velocity-dependent force and provide a energy dissipation mechanism. The dashpot coefficient is calculated:
	
	\begin{equation}
		C_1=\rho V_p A
	\end{equation}
	\begin{equation}
		C_2=\rho V_s A
	\end{equation}
	where $V_s$ and $V_s$ are the compressive and shear wave velocities of the soil, $\rho$ is the soil density, A is the tributary area of the element assigned with dashpot and $C_1$, $C_2$ are the dashpots coefficients for normal and tangential direction.  
	
	It is worth mentioning few assumptions related to wave propagation which simplify the problem without suffering from loss of accuracy:
	\begin{itemize}
		\item only vertically propagating seismic waves were taken into account; firstly, because a distinctive feature of this specific induced earthquake are the dominant shear waves. Secondly, because the free-field soil was also subjected to S-waves exclusively. And thirdly, because the two body waves are independent of each other. Thus, the compressive waves do not influence the soil-structure behaviour for now.
		\item the body waves travel towards the lateral boundaries under an incidence angle of $\theta = 0$. Basically, there are no \textit{evanescent waves} within the deformable body, waves that occur due to combinations of boundary conditions and, unlike the P and S-waves, are frequency dependent.
	\end{itemize}
	
	With these being said, the main model consists of:

	BC; explica feature din abaqus si cum rezolva.
	\paragraph{Equivalent forces}
	\paragraph{Displacements}
	 

\section{Results}
\subsection{Effects of applied boundary conditions}
\subsection{Effects of loads}
\subsection{FBC vs TSI}

\section{Limitations and recommendations}
\section{Conclusions}

